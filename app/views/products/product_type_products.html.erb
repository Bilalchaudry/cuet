<%#= raw @product_type.seo_tags %>
<% if !@product_type %>
  <div class="row pt-4 mt-4">
    <div class="container pt-4 mt-4">
      <div class="row">
        <div class="col-12">
          <div class="section-heading text-center">
            <h2 style="color: darkgreen;">Products are coming soon...!</h2>
          </div>
        </div>
      </div>
    </div>
  </div>
<% else %>
  <div class="row pt-4 mt-4">
    <div class="container pt-4 mt-4">
      <div class="row">
        <div class="col-12">
          <div class="section-heading text-center">
            <h2 style="color: white;"><%= @product_type.name %> Products</h2>
          </div>
        </div>
      </div>
    </div>
    <% @products.each do |product| %>
      <div class="col-lg-3 mb-4">
        <div class="product-img">
          <%= image_tag product.photo_url rescue nil %>
        </div>
        <div class="product-description">
          <p class="product-type-name"> <%= product.product_type.name %></p>
          <%= link_to product_show_path(id: product.friendly_id) do %>
            <h5> <%= product.name %></h5>
          <% end %>
          <h5 class="card-subtitle"> <%= product.title %></h5>
<!--          <p class="mt-2">PKR <%#= product.price %></p>-->
          <div class="row">
            <% if product.original_price %>
              <div class="price-container" style="display: flex; justify-content: space-between; align-items: center;">
                <p class="mt-1" style="text-decoration: line-through; font-size: 20px; color: black; margin: 0; color: #006D77;">
                  PKR <%= product.original_price %>
                </p>
                <span class="mt-2" style="font-size: 20px; color: black; margin: 0; color: #E29578;">
    PKR <%= product.price %>
  </span>
              </div>

            <% else %>
              <p class="mt-2" style="font-size: 20px; color: #E29578;">PKR <%= product.price %></p>
            <% end %>
          </div>
          <div class="add-to-cart-btn">
            <% if current_client %>
              <% certs = current_client&.certs.find_by(ordered?: false) if current_client&.certs %>
              <% if certs && certs&.cert_products.pluck(:product_id).include?(product.id) %>
                <a id="<%= product.id %>" style="pointer-events:none; cursor:default; width: 100%; background: grey;" onclick="saveData(<%= product.id %>)" class="btn essence-btn">Already
                  added</a>
                <!--                  <div class="bottom d-flex flex-row justify-content-center" style="border-bottom: 5px solid;">-->

                <!--                    <div class="input-group mb-3" style="width: 100% !important;">-->
                <!--                      <span class="input-group-text">-</span>-->
                <%# byebug %>
                <!--                      <input type="text" class="form-control" style="text-align: center;" value="<%#= certs&.cert_products.find_by(product_id: product.id).quantity %>">-->
                <!--                      <span class="input-group-text">+</span>-->
                <!--                    </div>-->
                <!--                  </div>-->
              <% else %>
                <a id="<%= product.id %>" onclick="saveData(<%= product.id %>)" class="btn essence-btn" style="width: 100% !important; background: #006D77 !important;">Add
                  to
                  Cart</a>
              <% end %>
            <% else %>
              <!--                <div class="bottom d-flex flex-row justify-content-center">-->

              <!--                  <div class="input-group mb-3" style="width: 100% !important;">-->
              <!--                    <span class="input-group-text">+</span>-->
              <!--                    <input type="text" class="form-control" style="text-align: center;" value="1">-->
              <!--                    <span class="input-group-text">-</span>-->
              <!--                  </div>-->
              <!--                </div>-->
              <a href="/clients/sign_in" class="btn essence-btn" style="width: 100% !important; background: #006D77 !important;">Add
                to Cart</a>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
<style>
    .price-container {
        margin-bottom: 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .price-container p {
        text-decoration: line-through;
        font-size: 20px;
    }

    .price-container span {
        font-size: 20px;
    }
</style>
